{
  "hash": "51db0b13f71e2fa65c780ae8ebf74367",
  "result": {
    "markdown": "---\ntitle: \"Qualitative Response Regression Models\"\nsubtitle: 'LPM vs Logit models'\nauthor: \"Juan Quinonez\"\nformat: html\neditor: visual\nbibliography: bibliography.bib\ntbl-cap-location: top\n---\n\n\nIn this post we will explore two different models that use a dichotomous variable as the response variable.\n\n## Introduction\n\nGenerally, the dependent variable is a quantitative variable, however, sometimes the response variable may be a qualitative variable. This is the case, for example, when trying to forecast some one's favorite ice cream flavor or to predict if someone will default on his payments in the next few months.\n\nWorking with qualitative variable can be simplified by converting it into a binary variable. This can be done by creating a variable for each category of the qualitative variable that is 1 when one category is present and 0 when it is not.\n\nThis post will detail the Linear Probability Model (LPM) and the Logistic Regression Model (LOGIT) as covered by Gujarati [-@Guj2003]. For these models we will use the Pima Indians Diabetes Database from the `mlbench` package. With this dataset will try to predict if a person has type 2 diabetes based on some explanatory variables. This database has information of 724 patients where 475 of them didn't have diabetes. [@tbl-pidb] shows the summary statistics of this database.\n\n\n::: {#tbl-pidb .cell tbl-cap='Pima Indians Diabetes Database'}\n\n```{.r .cell-code}\n# Data\ndata(\"PimaIndiansDiabetes2\", package = \"mlbench\")\n\nPimaIndiansDiabetes2 <- PimaIndiansDiabetes2 |>\n  dplyr::select(-c(triceps, insulin)) |> # Excluded due to too many missing values\n  na.omit() |> \n  dplyr::mutate(mass = cut(mass,\n                           breaks = c(-Inf, 18.5, 24.9, 29.9, Inf),\n                           labels = c('Underweight', 'Normal range', 'Overweight', 'Obese'),\n                           right = TRUE))\n\nlabelled::var_label(PimaIndiansDiabetes2) <- \n  list(pregnant = 'Number of times pregnant',\n       glucose = 'Plasma glucose concentration',\n       pressure = 'Diastolic blood pressure (mm Hg)',\n       mass = 'Body mass index',\n       pedigree = 'Diabetes pedigree function',\n       age = 'Age (years)',\n       diabetes = 'Test for diabetes')\n\n\n# Summary table\nPimaIndiansDiabetes2 |> \n  gtsummary::tbl_summary(by = diabetes,\n                         statistic = list(gtsummary::all_continuous() ~ \"{mean} ({sd})\",\n                                          gtsummary::all_categorical() ~ \"{n} / {N} ({p}%)\"),\n                         digits = gtsummary::all_continuous() ~ 2) |> \n  gtsummary::add_overall()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"keojjdbuil\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#keojjdbuil .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#keojjdbuil .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#keojjdbuil .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#keojjdbuil .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#keojjdbuil .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#keojjdbuil .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#keojjdbuil .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#keojjdbuil .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#keojjdbuil .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#keojjdbuil .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#keojjdbuil .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#keojjdbuil .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#keojjdbuil .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#keojjdbuil .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#keojjdbuil .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#keojjdbuil .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#keojjdbuil .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#keojjdbuil .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#keojjdbuil .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#keojjdbuil .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#keojjdbuil .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#keojjdbuil .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#keojjdbuil .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#keojjdbuil .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#keojjdbuil .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#keojjdbuil .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#keojjdbuil .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#keojjdbuil .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#keojjdbuil .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#keojjdbuil .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#keojjdbuil .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#keojjdbuil .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#keojjdbuil .gt_left {\n  text-align: left;\n}\n\n#keojjdbuil .gt_center {\n  text-align: center;\n}\n\n#keojjdbuil .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#keojjdbuil .gt_font_normal {\n  font-weight: normal;\n}\n\n#keojjdbuil .gt_font_bold {\n  font-weight: bold;\n}\n\n#keojjdbuil .gt_font_italic {\n  font-style: italic;\n}\n\n#keojjdbuil .gt_super {\n  font-size: 65%;\n}\n\n#keojjdbuil .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#keojjdbuil .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#keojjdbuil .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#keojjdbuil .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#keojjdbuil .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#keojjdbuil .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#keojjdbuil .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Overall&lt;/strong&gt;, N = 724&lt;sup class=&quot;gt_footnote_marks&quot;&gt;1&lt;/sup&gt;\"><strong>Overall</strong>, N = 724<sup class=\"gt_footnote_marks\">1</sup></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;neg&lt;/strong&gt;, N = 475&lt;sup class=&quot;gt_footnote_marks&quot;&gt;1&lt;/sup&gt;\"><strong>neg</strong>, N = 475<sup class=\"gt_footnote_marks\">1</sup></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;pos&lt;/strong&gt;, N = 249&lt;sup class=&quot;gt_footnote_marks&quot;&gt;1&lt;/sup&gt;\"><strong>pos</strong>, N = 249<sup class=\"gt_footnote_marks\">1</sup></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Number of times pregnant</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">3.87 (3.36)</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">3.32 (3.03)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">4.91 (3.71)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Plasma glucose concentration</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">121.88 (30.75)</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">111.02 (25.01)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">142.61 (30.06)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Diastolic blood pressure (mm Hg)</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">72.40 (12.38)</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">70.91 (12.17)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">75.25 (12.29)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Body mass index</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Underweight</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">4 / 724 (0.6%)</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">4 / 475 (0.8%)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">0 / 249 (0%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Normal range</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">96 / 724 (13%)</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">89 / 475 (19%)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">7 / 249 (2.8%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Overweight</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">171 / 724 (24%)</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">133 / 475 (28%)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">38 / 249 (15%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Obese</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">453 / 724 (63%)</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">249 / 475 (52%)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">204 / 249 (82%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Diabetes pedigree function</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">0.47 (0.33)</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">0.43 (0.30)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">0.56 (0.38)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Age (years)</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">33.35 (11.77)</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">31.26 (11.56)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">37.34 (11.12)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><sup class=\"gt_footnote_marks\">1</sup> Mean (SD); n / N (%)</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Linear Probability Model\n\nGenerally we can consider a linear model as:\n\n$$\nY_i = \\beta_1 + \\beta_2 X_i + u_i\n$$ {#eq-lpm} where $X_i$ represents a vector of independent variables and $Y_i$ takes value of 1 if the person has diabetes and 0 otherwise. [@eq-lpm] instead of being a typical linear regression is now a linear probabilistic regression, because the dependent variable is a binary variable. Now $Y_i$ will give us the conditional probability given $X_i$, $P(Y_i = 1|X_i)$. Assuming that $E(u_i) = 0$, we can write:\n\n$$\nE(Y_i|X_I) = \\beta_1 + \\beta_2 X_i = P_i\n$$ {#eq-lpm-exp} The LPM model has several shortfalls that are detailed in Gujarati [-@Guj2003]. In this section we will focus on the fact that these models are unbounded and can thus produce probabilities outside $0 \\leq P_i \\leq 1$. If we try to explain the probability of having diabetes using plasma glucose concentration we'll get the response shown in [@fig-lpm].\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data\ntest <- PimaIndiansDiabetes2 |> \n  dplyr::mutate(diabetes = ifelse(diabetes == 'pos',1,0))\n\n# LPM\nlpm <- lm(diabetes ~ glucose, data = test)\ntest$lpm.yhat <- predict(lpm)\n\n# Plot\nlibrary(ggplot2)\ntest |> \n  ggplot() +\n  geom_point(aes(y = diabetes, x = glucose)) +\n  geom_line(aes(y = lpm.yhat, x = glucose, color = 'LPM'), linewidth = 1.3) +\n  labs(x = \"Glucose\",\n       y = \"Diabetes\") +\n  scale_color_manual(name = 'Model',\n                     breaks = c('LPM'),\n                     values = c(\"LPM\" = \"blue\")) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Linear Probability Model](index_files/figure-html/fig-lpm-1.png){#fig-lpm width=672}\n:::\n:::\n\n\nThis graphs shows that for plasma glucose concentration lower than 76.5 the probability of having diabetes is negative and if the plasma glucose concentration is higher than 208, then this probability will be over 100%.\n\n## Logit Models\n\nBinary variables often follow a Bernoulli probability distribution, which can be refreshed in Rodríguez [-@Rod2007].\n\nConsider [@eq-lpm-1] as an alternative representation of [@eq-lpm], where $Z_i=\\beta_1+\\beta_2X_i$.\n\n$$\nP_i = E(Y_i|X_i) = \\frac{1}{1+e^{-(\\beta_1 + \\beta_2X_i)}} = \\frac{e^{Z_i}}{1 + e^{Z_i}}\n$$ {#eq-lpm-1}\n\nThis new definition bounds $P_i$ between 0 and 1, overcoming LPM shortfall, however, there is a new problem: we can no longer use OLS to estimate the coefficients directly. If $P_i$ is the probability of being diabetic, then $1-P_i$ is the probability of *not* being diabetic. The *odds-ratio* in favor of being diabetic is:\n\n$$\n\\frac{P_i}{1-P_i}=\\frac{\\frac{e^{Z_i}}{1+e^{Z_i}}}{\\frac{1}{1+e^{Z_i}}}=\\frac{1+e^{Z_i}}{1+e^{-Z_i}}=e^{Z_i}\n$$ {#eq-odds-ratio}\n\nIf $P_i=0.8$ then the odds of being diabetic is 4 times larger than not being diabetic. Now, taking the natural log of [@eq-odds-ratio] we'll get a linear version of the last equation.\n\n$$\nL_i = \\ln{\\frac{P_i}{1-P_i}}=Z_i=\\beta_1+\\beta_2X_i\n$$ Although we cannot estimate the parameters using regular OLS, we can do so using maximum likelihood approach. [@fig-lpm_logit] shows the result of the last exercise, using logit model and comparing it to the LPM.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Logit\nlogit <- glm(diabetes ~ glucose, \n             data = test,\n             family = binomial(link=\"logit\"))\ntest$logit.yhat <- predict(logit, type=\"response\")\n\n# Plot\ntest |> \n  ggplot() +\n  geom_point(aes(y = diabetes, x = glucose)) +\n  geom_line(aes(y = lpm.yhat, x = glucose, color = 'LPM'), linewidth = 1.3) +\n  geom_line(aes(y = logit.yhat, x = glucose, color = 'Logit'), linewidth = 1.5) +\n  labs(x = \"Glucose\",\n       y = \"Diabetes\") +\n  scale_color_manual(name = 'Model',\n                     breaks = c('LPM', 'Logit'),\n                     values = c(\"LPM\" = \"blue\",\n                                \"Logit\" = \"green\")) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Linear Probability Model vs Logit Model](index_files/figure-html/fig-lpm_logit-1.png){#fig-lpm_logit width=672}\n:::\n:::\n\n\nWe can further explore other factors that can explain the probability of being diabetic and use this for illustrate how to interpret the results. We will be estimating the following model\n\n$$\nL_i=\\frac{P_i}{1-P_i}=\\beta_1+\\beta2Age+\\beta3Glucose+\\beta4Mass+u_i\n$$\n\n\n::: {#tbl-logit .cell tbl-cap='Logit Model Summary'}\n\n```{.r .cell-code}\n# Logit\nlogit <- glm(diabetes ~ age + glucose, \n             data = test,\n             family = binomial(link=\"logit\"))\n\n# LPM\nlpm <- glm(diabetes ~ age + glucose, \n             data = test,\n             family = gaussian(link = \"identity\"))\n\n# Table\nsjPlot::tab_model(lpm, logit,\n                  dv.labels = c(\"LPM\", \"Logit\"),\n                  digits = 4,\n                  transform = 'exp')\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">LPM</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">Logit</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7\">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.5050</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.4414&nbsp;&ndash;&nbsp;0.5777</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.0020</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.0007&nbsp;&ndash;&nbsp;0.0050</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Age(years)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.0051</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.0024&nbsp;&ndash;&nbsp;1.0078</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.0269</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.0115&nbsp;&ndash;&nbsp;1.0426</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Plasma glucose<br>concentration</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.0071</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.0060&nbsp;&ndash;&nbsp;1.0081</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.0379</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.0311&nbsp;&ndash;&nbsp;1.0451</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">724</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">724</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.253</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.256</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n[@tbl-logit] shows the summary for both LP and Logit models. Each of the coefficients of the Logit model is a *partial slope* and measures the change in the estimated logit for a unit change in the value of the given regressor (holding other regressors constant). For one unit increase of the *Age* variable (holding all other variables constant) there will be a (1.0269 - 1 = ) 2.69% increase in the odds of having diabetes.\n\nDickson [-@Dickson2022] expands on how to interpret odd ratios with very useful examples.\n\n## Model Comparison\n\nBoth models (Logit and Linear Probability) yield very similar results, because both of them are very simple. In order to compare both models we'll be analyzing the difference of the predicted probability (Logit vs LPM) of having diabetes. [@fig-prob] shows that the LP model yields negative probabilities for some cases, whereas the Logit model will always produce positive probabilities.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Logit\ntest$logit.prob <- predict(logit, type=\"response\")\n\n# LPM\ntest$lpm.prob <- predict(lpm, type=\"response\")\n\n# Difference\ntest$model_diff <- test$logit.prob - test$lpm.prob\n\ntest |> \n  ggplot() +\n  geom_line(aes(y = test$logit.prob, x = test$lpm.prob)) +\n  geom_vline(xintercept = 0) +\n  labs(x = 'LPM',\n       y = 'Logit') +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![Probability Comparison](index_files/figure-html/fig-prob-1.png){#fig-prob width=672}\n:::\n:::\n\n\n## Conclussion\n\nIn this post we explored two different models that use a dichotomous variable as the response variable (LPM and Logit model). We highlighted the main difference and commented on how to interpreted the results of the Logit model.\n\nIn further post we will cover how to analyze model performance, comparing the results of different models and determining which one is better.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}